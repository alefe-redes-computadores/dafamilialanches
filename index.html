<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Da FamÃ­lia Lanches ğŸ”</title>

  <!-- Ãcone e CSS -->
  <link rel="icon" href="favicon.png" />
  <link rel="stylesheet" href="style.css" />

  <!-- Firebase v8 (para login Google quando quiser ativar no JS) -->
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>

  <!-- Leaflet (mapa) -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

  <!-- Script principal -->
  <script defer src="script.js"></script>
</head>

<body>
  <!-- Ãcone do carrinho -->
  <button id="cart-icon" aria-label="Abrir carrinho">ğŸ›’ <span id="cart-count">0</span></button>

  <!-- CabeÃ§alho -->
  <header class="header">
    <div class="header-content">
      <img src="logo.png" class="logo" alt="Logo DFL" />
      <div class="header-info">
        <h1>Da FamÃ­lia Lanches</h1>
        <p class="tagline">O sabor que une a famÃ­lia ğŸ”</p>
      </div>
    </div>
    <!-- BotÃ£o de login Ã© injetado pelo JS (id: user-btn) -->
  </header>

  <!-- Banner de status -->
  <div id="status-banner" class="status-banner">Verificando horÃ¡rio...</div>

  <!-- HorÃ¡rios fixos -->
  <div class="hours-banner">
    <span>ğŸ•’ Segâ€“Qui <b>18hâ€“23h15</b></span> â€¢
    <span>Sexâ€“Dom <b>17h30â€“23h30</b></span> â€¢
    <span>Ter <b>Fechado</b></span>
  </div>

  <!-- PromoÃ§Ãµes -->
  <section class="promo-section">
    <h2>ğŸ”¥ PromoÃ§Ãµes do Dia</h2>
    <p class="promo-sub">VÃ¡lidas atÃ© 23h59 ou enquanto durarem os estoques</p>
    <div class="countdown-ticker">
      â° Termina em: <span id="timer">00:00:00</span>
    </div>

    <div id="promoCarousel" class="carousel">
      <button class="c-btn c-prev" aria-label="Anterior">â—€</button>
      <div class="slides">
        <img class="slide" src="promo1.jpg" alt="Promo 1" data-wa="Quero a promoÃ§Ã£o 1" />
        <img class="slide" src="promo2.jpg" alt="Promo 2" data-wa="Quero a promoÃ§Ã£o 2" />
        <img class="slide" src="promo3.jpg" alt="Promo 3" data-wa="Quero a promoÃ§Ã£o 3" />
        <img class="slide" src="promo4.jpg" alt="Promo 4" data-wa="Quero a promoÃ§Ã£o 4" />
        <img class="slide" src="promo5.jpg" alt="Promo 5" data-wa="Quero a promoÃ§Ã£o 5" />
        <img class="slide" src="promo6.jpg" alt="Promo 6" data-wa="Quero a promoÃ§Ã£o 6" />
        <img class="slide" src="promo7.jpg" alt="Promo 7" data-wa="Quero a promoÃ§Ã£o 7" />
        <img class="slide" src="promo8.jpg" alt="Promo 8" data-wa="Quero a promoÃ§Ã£o 8" />
      </div>
      <button class="c-btn c-next" aria-label="PrÃ³xima">â–¶</button>
    </div>
  </section>
<!-- ======================= -->
  <!-- HambÃºrgueres Tradicionais -->
  <!-- ======================= -->
  <section class="menu-section">
    <h2>ğŸ” HambÃºrgueres Tradicionais</h2>
    <div class="grid">
      <article class="card" data-id="BAO" data-name="BÃƒO" data-price="11.00">
        <h3>BÃƒO <span class="badge">Com Molho Verde ğŸŒ¿</span></h3>
        <div class="price">R$ 11,00</div>
        <p>PÃ£o, alface, tomate, hambÃºrguer, presunto e mussarela.</p>
        <div class="actions"><button class="add-cart">Adicionar</button><button class="extras-btn">Adicionais</button></div>
      </article>

      <article class="card" data-id="UAI" data-name="UAI" data-price="13.00">
        <h3>UAI <span class="badge">Com Molho Verde ğŸŒ¿</span></h3>
        <div class="price">R$ 13,00</div>
        <p>PÃ£o, alface, tomate, milho, bacon, hambÃºrguer, presunto e mussarela.</p>
        <div class="actions"><button class="add-cart">Adicionar</button><button class="extras-btn">Adicionais</button></div>
      </article>

      <article class="card" data-id="TREM" data-name="TREM" data-price="14.00">
        <h3>TREM <span class="badge">Com Molho Verde ğŸŒ¿</span></h3>
        <div class="price">R$ 14,00</div>
        <p>PÃ£o, alface, tomate, milho, bacon, salsicha, hambÃºrguer, presunto e mussarela.</p>
        <div class="actions"><button class="add-cart">Adicionar</button><button class="extras-btn">Adicionais</button></div>
      </article>

      <article class="card" data-id="CADIM" data-name="CADIM" data-price="17.00">
        <h3>CADIM <span class="badge">Com Molho Verde ğŸŒ¿</span></h3>
        <div class="price">R$ 17,00</div>
        <p>PÃ£o, alface, tomate, milho, bacon, salsicha, hambÃºrguer, filÃ© de frango, presunto e mussarela.</p>
        <div class="actions"><button class="add-cart">Adicionar</button><button class="extras-btn">Adicionais</button></div>
      </article>

      <article class="card" data-id="ARMARIA" data-name="ARMARIA" data-price="18.00">
        <h3>ARMARIA <span class="badge">Com Molho Verde ğŸŒ¿</span></h3>
        <div class="price">R$ 18,00</div>
        <p>PÃ£o, alface, tomate, milho, bacon, salsicha, hambÃºrguer, filÃ© de frango, batata palha, presunto e mussarela.</p>
        <div class="actions"><button class="add-cart">Adicionar</button><button class="extras-btn">Adicionais</button></div>
      </article>

      <article class="card" data-id="BITELA" data-name="BITELA" data-price="22.00">
        <h3>BITELA <span class="badge">Com Molho Verde ğŸŒ¿</span></h3>
        <div class="price">R$ 22,00</div>
        <p>PÃ£o, alface, tomate, milho, bacon, salsicha, 2 hambÃºrgueres, filÃ© de frango, batata palha, presunto e mussarela.</p>
        <div class="actions"><button class="add-cart">Adicionar</button><button class="extras-btn">Adicionais</button></div>
      </article>

      <article class="card" data-id="GRADICIDO" data-name="GRADICIDO" data-price="28.00">
        <h3>GRADICIDO <span class="badge">Com Molho Verde ğŸŒ¿</span></h3>
        <div class="price">R$ 28,00</div>
        <p>PÃ£o, alface, tomate, milho, bacon, salsicha, 3 hambÃºrgueres, filÃ© de frango, ovo, batata palha, presunto e mussarela.</p>
        <div class="actions"><button class="add-cart">Adicionar</button><button class="extras-btn">Adicionais</button></div>
      </article>

      <article class="card" data-id="VARADIFOME" data-name="VARADIFOME" data-price="30.00">
        <h3>VARADIFOME <span class="badge">Com Molho Verde ğŸŒ¿</span></h3>
        <div class="price">R$ 30,00</div>
        <p>PÃ£o, alface, tomate, milho, bacon, salsicha, 4 hambÃºrgueres, filÃ© de frango, ovo, batata palha, presunto e mussarela.</p>
        <div class="actions"><button class="add-cart">Adicionar</button><button class="extras-btn">Adicionais</button></div>
      </article>

      <article class="card" data-id="APRUMA" data-name="APRUMA" data-price="25.00">
        <h3>APRUMA <span class="badge">Com Molho Verde ğŸŒ¿</span></h3>
        <div class="price">R$ 25,00</div>
        <p>PÃ£o, alface, tomate, milho, bacon, salsicha, 3 hambÃºrgueres, filÃ© de frango, batata palha, presunto e mussarela.</p>
        <div class="actions"><button class="add-cart">Adicionar</button><button class="extras-btn">Adicionais</button></div>
      </article>
    </div>
  </section>

  <!-- HambÃºrgueres Artesanais -->
  <section class="menu-section">
    <h2>ğŸ” HambÃºrgueres Artesanais</h2>
    <div class="grid">
      <article class="card" data-id="PELEJA" data-name="PELEJA" data-price="26.00">
        <h3>PELEJA <span class="badge">Com Molho Verde ğŸŒ¿</span></h3>
        <div class="price">R$ 26,00</div>
        <p>PÃ£o, alface, tomate, milho, bacon, hambÃºrguer artesanal 120g, filÃ© de frango, presunto e mussarela.</p>
        <div class="actions"><button class="add-cart">Adicionar</button><button class="extras-btn">Adicionais</button></div>
      </article>

      <article class="card" data-id="TUDIBOM" data-name="TUDIBOM" data-price="28.50">
        <h3>TUDIBOM <span class="badge">Com Molho Verde ğŸŒ¿</span></h3>
        <div class="price">R$ 28,50</div>
        <p>PÃ£o, alface, tomate, milho, bacon, 2 hambÃºrgueres artesanais 120g, filÃ© de frango, presunto e mussarela.</p>
        <div class="actions"><button class="add-cart">Adicionar</button><button class="extras-btn">Adicionais</button></div>
      </article>

      <article class="card" data-id="CUSTOSO" data-name="CUSTOSO" data-price="31.00">
        <h3>CUSTOSO <span class="badge">Com Molho Verde ğŸŒ¿</span></h3>
        <div class="price">R$ 31,00</div>
        <p>PÃ£o, alface, tomate, milho, bacon, 2 hambÃºrgueres artesanais 120g, filÃ© de frango, cheddar cremoso, presunto e mussarela.</p>
        <div class="actions"><button class="add-cart">Adicionar</button><button class="extras-btn">Adicionais</button></div>
      </article>
    </div>
  </section>

  <!-- Combos -->
  <section class="menu-section">
    <h2>ğŸ Combos</h2>
    <div class="grid">
      <article class="card" data-id="CC_TRAD" data-name="Combo Casal (Tradicional)" data-price="34.99">
        <h3>Combo Casal (Tradicional)</h3>
        <div class="price">R$ 34,99</div>
        <p>2 HambÃºrguer Trem + 1 Fanta 1L.</p>
        <div class="actions"><button class="add-cart">Adicionar</button></div>
      </article>

      <article class="card" data-id="CF_TRAD" data-name="Combo FamÃ­lia (Tradicional)" data-price="59.99">
        <h3>Combo FamÃ­lia (Tradicional)</h3>
        <div class="price">R$ 59,99</div>
        <p>4 HambÃºrguer Trem + 1 Kuat 2L.</p>
        <div class="actions"><button class="add-cart">Adicionar</button></div>
      </article>

      <article class="card" data-id="CC_ART" data-name="Combo Casal (Artesanal)" data-price="54.99">
        <h3>Combo Casal (Artesanal)</h3>
        <div class="price">R$ 54,99</div>
        <p>2 HambÃºrguer Peleja + 1 Coca 1L.</p>
        <div class="actions"><button class="add-cart">Adicionar</button></div>
      </article>

      <article class="card" data-id="CF_ART" data-name="Combo FamÃ­lia (Artesanal)" data-price="79.99">
        <h3>Combo FamÃ­lia (Artesanal)</h3>
        <div class="price">R$ 79,99</div>
        <p>4 HambÃºrguer Peleja + 1 Coca 2L.</p>
        <div class="actions"><button class="add-cart">Adicionar</button></div>
      </article>
    </div>
  </section>

  <!-- Hot Dogs -->
  <section class="menu-section">
    <h2>ğŸŒ­ Hot Dogs</h2>
    <div class="grid">
      <article class="card" data-id="NIGUCIM" data-name="NIGUCIM" data-price="10.00">
        <h3>NIGUCIM</h3>
        <div class="price">R$ 10,00</div>
        <p>PÃ£o, molho, salsicha (Sadia/PerdigÃ£o), milho, batata palha, ketchup e maionese.</p>
        <div class="actions"><button class="add-cart">Adicionar</button><button class="extras-btn">Adicionais</button></div>
      </article>

      <article class="card" data-id="SIMPRAO" data-name="SIMPRÃƒO" data-price="12.00">
        <h3>SIMPRÃƒO</h3>
        <div class="price">R$ 12,00</div>
        <p>PÃ£o, molho, salsicha, milho, batata palha, bacon, ketchup e maionese.</p>
        <div class="actions"><button class="add-cart">Adicionar</button><button class="extras-btn">Adicionais</button></div>
      </article>

      <article class="card" data-id="NIMIM" data-name="NIMIM" data-price="13.00">
        <h3>NIMIM</h3>
        <div class="price">R$ 13,00</div>
        <p>PÃ£o, molho, 2 salsichas, milho, batata palha, bacon, ketchup, maionese e vinagrete.</p>
        <div class="actions"><button class="add-cart">Adicionar</button><button class="extras-btn">Adicionais</button></div>
      </article>

      <article class="card" data-id="PADANA" data-name="PADANÃ" data-price="15.00">
        <h3>PADANÃ</h3>
        <div class="price">R$ 15,00</div>
        <p>PÃ£o, molho, 2 salsichas, milho, batata palha, bacon, vinagrete, mussarela, ketchup e maionese.</p>
        <div class="actions"><button class="add-cart">Adicionar</button><button class="extras-btn">Adicionais</button></div>
      </article>

      <article class="card" data-id="PURIZIM" data-name="PURIZIM" data-price="14.00">
        <h3>PURIZIM</h3>
        <div class="price">R$ 14,00</div>
        <p>PÃ£o, molho, milho, purÃª de batata cremoso, 1 salsicha, batata palha, ketchup e maionese.</p>
        <div class="actions"><button class="add-cart">Adicionar</button><button class="extras-btn">Adicionais</button></div>
      </article>

      <article class="card" data-id="TREMBAO" data-name="TREMBÃƒO" data-price="17.00">
        <h3>TREMBÃƒO</h3>
        <div class="price">R$ 17,00</div>
        <p>PÃ£o, molho, milho, purÃª de batata, 2 salsichas, bacon, mussarela, batata palha, vinagrete, ketchup e maionese.</p>
        <div class="actions"><button class="add-cart">Adicionar</button><button class="extras-btn">Adicionais</button></div>
      </article>
    </div>
  </section>

  <!-- Bebidas -->
  <section class="menu-section">
    <h2>ğŸ¥¤ Bebidas e Refrigerantes</h2>
    <div class="grid">
      <article class="card" data-id="coca200" data-name="Coca-Cola 200ml" data-price="4.00"><h3>Coca-Cola 200ml</h3><div class="price">R$ 4,00</div><div class="actions"><button class="add-cart">Adicionar</button></div></article>
      <article class="card" data-id="aguaG" data-name="Ãgua com GÃ¡s" data-price="3.00"><h3>Ãgua com GÃ¡s</h3><div class="price">R$ 3,00</div><div class="actions"><button class="add-cart">Adicionar</button></div></article>
      <article class="card" data-id="coca310" data-name="Coca-Cola 310ml" data-price="5.00"><h3>Coca-Cola 310ml</h3><div class="price">R$ 5,00</div><div class="actions"><button class="add-cart">Adicionar</button></div></article>
      <article class="card" data-id="coca310zero" data-name="Coca-Cola 310ml Zero" data-price="5.00"><h3>Coca-Cola 310ml Zero</h3><div class="price">R$ 5,00</div><div class="actions"><button class="add-cart">Adicionar</button></div></article>
      <article class="card" data-id="uva450" data-name="Del Valle Uva 450ml" data-price="5.00"><h3>Del Valle Uva 450ml</h3><div class="price">R$ 5,00</div><div class="actions"><button class="add-cart">Adicionar</button></div></article>
      <article class="card" data-id="laranja450" data-name="Del Valle Laranja 450ml" data-price="5.00"><h3>Del Valle Laranja 450ml</h3><div class="price">R$ 5,00</div><div class="actions"><button class="add-cart">Adicionar</button></div></article>
      <article class="card" data-id="fanta1l" data-name="Fanta Laranja 1L" data-price="8.00"><h3>Fanta Laranja 1L</h3><div class="price">R$ 8,00</div><div class="actions"><button class="add-cart">Adicionar</button></div></article>
      <article class="card" data-id="coca1l" data-name="Coca-Cola 1L" data-price="9.00"><h3>Coca-Cola 1L</h3><div class="price">R$ 9,00</div><div class="actions"><button class="add-cart">Adicionar</button></div></article>
      <article class="card" data-id="coca1lzero" data-name="Coca-Cola 1L Zero" data-price="9.00"><h3>Coca-Cola 1L Zero</h3><div class="price">R$ 9,00</div><div class="actions"><button class="add-cart">Adicionar</button></div></article>
      <article class="card" data-id="kuat2l" data-name="Kuat GuaranÃ¡ 2L" data-price="10.00"><h3>Kuat GuaranÃ¡ 2L</h3><div class="price">R$ 10,00</div><div class="actions"><button class="add-cart">Adicionar</button></div></article>
      <article class="card" data-id="coca2l" data-name="Coca-Cola 2L" data-price="13.00"><h3>Coca-Cola 2L</h3><div class="price">R$ 13,00</div><div class="actions"><button class="add-cart">Adicionar</button></div></article>
    </div>
  </section>
/* =========================================================
   DFL â€“ Script estÃ¡vel
   - Som de clique
   - Status aberto/fechado + countdown
   - Carrossel (setas + clique -> WhatsApp)
   - Carrinho com fechar (âœ•, backdrop e ESC)
   - Adicionais (lista oficial)
   - Modal de login (UI) + botÃ£o Google (placeholder)
========================================================= */

/* -------- Som de clique -------- */
const clickSfx = new Audio("click.wav");
clickSfx.volume = 0.35;
function playClick(){ try{ clickSfx.currentTime=0; clickSfx.play(); }catch(_){} }
document.addEventListener("click", playClick, { passive:true });

/* -------- Estado do carrinho -------- */
let cart = JSON.parse(localStorage.getItem("cart") || "[]");
const cartCount = document.getElementById("cart-count");
function saveCart(){ localStorage.setItem("cart", JSON.stringify(cart)); updateCartUI(); }
function money(n){ return `R$ ${Number(n).toFixed(2).replace(".", ",")}`; }
function updateCartUI(){
  // badge
  cartCount.textContent = cart.reduce((a,i)=>a+(i.qtd||1),0);

  // lista
  const list = document.getElementById("mini-list");
  if (!list) return;

  if (!cart.length){
    list.innerHTML = `<p class="empty-cart">Seu carrinho estÃ¡ vazio.</p>`;
  } else {
    list.innerHTML = "";
    cart.forEach((it,idx)=>{
      const row = document.createElement("div");
      row.className = "cart-item";
      row.innerHTML = `
        <div style="flex:1;min-width:0">
          <span>${it.nome}</span><br>
          <small>${money(it.preco)}</small>
        </div>
        <div style="display:flex;align-items:center;gap:6px;">
          <button class="qty-dec" data-i="${idx}">âˆ’</button>
          <span>${it.qtd}</span>
          <button class="qty-inc" data-i="${idx}">+</button>
          <strong>${money(it.preco*it.qtd)}</strong>
          <button class="remove-item" data-i="${idx}" title="Remover">x</button>
        </div>
      `;
      list.appendChild(row);
    });
  }

  // total + aÃ§Ãµes
  const foot = document.querySelector(".mini-foot");
  const total = cart.reduce((a,i)=>a+i.preco*i.qtd,0);
  foot.innerHTML = `
    <button id="mini-clear" class="btn-secondary">Limpar</button>
    <button id="mini-checkout" class="btn-primary">Fechar pedido (${money(total)})</button>
  `;
}

/* -------- Abertura/fechamento do mini-carrinho -------- */
const miniCart = document.getElementById("mini-cart");
const cartBackdrop = document.getElementById("cart-backdrop");
function openMiniCart(){
  updateCartUI();
  miniCart.classList.add("active");
  cartBackdrop.classList.add("show");
  document.body.classList.add("no-scroll");
}
function closeMiniCart(){
  miniCart.classList.remove("active");
  cartBackdrop.classList.remove("show");
  document.body.classList.remove("no-scroll");
}
document.getElementById("cart-icon")?.addEventListener("click", openMiniCart);
document.addEventListener("click",(e)=>{
  if (e.target.closest(".mini-close")) closeMiniCart();
  if (e.target === cartBackdrop) closeMiniCart();
});
document.addEventListener("keydown",(e)=>{ if(e.key==="Escape") closeMiniCart(); });

/* DelegaÃ§Ã£o de eventos dentro do carrinho */
document.addEventListener("click",(e)=>{
  // qty +
  if (e.target.matches(".qty-inc")){
    const i = Number(e.target.dataset.i);
    cart[i].qtd++; saveCart();
  }
  // qty -
  if (e.target.matches(".qty-dec")){
    const i = Number(e.target.dataset.i);
    cart[i].qtd = Math.max(1, cart[i].qtd-1); saveCart();
  }
  // remover
  if (e.target.matches(".remove-item")){
    const i = Number(e.target.dataset.i);
    cart.splice(i,1); saveCart();
  }
  // limpar
  if (e.target.matches("#mini-clear")){
    cart = []; saveCart();
  }
  // checkout -> WhatsApp
  if (e.target.matches("#mini-checkout")){
    if (!cart.length) return;
    const linhas = cart.map(i=>`â€¢ ${i.nome}${i.qtd>1?` x${i.qtd}`:""} â€” ${money(i.preco*i.qtd)}`);
    const total = money(cart.reduce((a,i)=>a+i.preco*i.qtd,0));
    const txt = `ğŸ” Pedido DFL:%0A%0A${linhas.join("%0A")}%0A%0ATotal: ${total}`;
    window.open(`https://wa.me/5534997178336?text=${txt}`,"_blank");
  }
});

/* -------- Adicionar ao carrinho / Extras -------- */
const ADICIONAIS = [
  { nome: "Cebola", preco: 0.99 },
  { nome: "Salada", preco: 1.99 },
  { nome: "Ovo", preco: 1.99 },
  { nome: "Bacon", preco: 2.99 },
  { nome: "HambÃºrguer Tradicional 56g", preco: 2.99 },
  { nome: "Cheddar Cremoso", preco: 3.99 },
  { nome: "FilÃ© de frango", preco: 5.99 },
  { nome: "HambÃºrguer Artesanal 120g", preco: 7.99 }
];

const extrasModal = document.getElementById("extras-modal");
const extrasList  = document.getElementById("extras-list");

function bindAddButtons(){
  document.querySelectorAll(".add-cart").forEach(btn=>{
    btn.addEventListener("click", ()=>{
      const card = btn.closest(".card");
      const nome = card.dataset.name || card.querySelector("h3")?.textContent?.trim() || "Item";
      const preco = parseFloat(card.dataset.price || "0");
      const found = cart.find(i=>i.nome===nome && i.preco===preco);
      if (found) found.qtd += 1;
      else cart.push({ nome, preco, qtd: 1 });
      saveCart();

      // popup
      const pop = document.createElement("div");
      pop.className = "popup-add";
      pop.textContent = `${nome} adicionado!`;
      document.body.appendChild(pop);
      setTimeout(()=>pop.remove(), 1400);
    });
  });
}

function bindExtrasButtons(){
  document.querySelectorAll(".extras-btn").forEach(btn=>{
    btn.addEventListener("click", ()=>{
      const card = btn.closest(".card");
      extrasModal.dataset.produto = card.dataset.name || card.querySelector("h3")?.textContent?.trim() || "Item";
      // monta lista
      extrasList.innerHTML = ADICIONAIS.map((a, i)=>`
        <label>
          <span>${a.nome} â€” ${money(a.preco)}</span>
          <input type="checkbox" value="${i}">
        </label>
      `).join("");
      extrasModal.classList.add("show");
      document.body.classList.add("no-scroll");
    });
  });

  // fechar/cancelar
  document.addEventListener("click",(e)=>{
    if (e.target.closest(".extras-close") || e.target.matches("#extras-cancel")){
      extrasModal.classList.remove("show");
      document.body.classList.remove("no-scroll");
    }
  });
  // confirmar
  document.getElementById("extras-add").addEventListener("click", ()=>{
    const nomeBase = extrasModal.dataset.produto || "Item";
    const sel = [...extrasList.querySelectorAll("input:checked")];
    if (sel.length){
      sel.forEach(c=>{
        const a = ADICIONAIS[Number(c.value)];
        cart.push({ nome: `${nomeBase} + ${a.nome}`, preco: a.preco, qtd: 1 });
      });
      saveCart();
    }
    extrasModal.classList.remove("show");
    document.body.classList.remove("no-scroll");
  });
}

/* -------- Carrossel (setas + clique -> WhatsApp) -------- */
function initCarousel(){
  const rail = document.querySelector(".slides");
  if (!rail) return;
  const prev = document.querySelector(".c-prev");
  const next = document.querySelector(".c-next");
  const step = ()=> Math.min(rail.clientWidth*0.9, 320);
  prev?.addEventListener("click", ()=> rail.scrollBy({left:-step(), behavior:"smooth"}));
  next?.addEventListener("click", ()=> rail.scrollBy({left: step(), behavior:"smooth"}));
  rail.querySelectorAll(".slide").forEach(img=>{
    img.addEventListener("click", ()=>{
      const wa = img.getAttribute("data-wa") || "Quero a promoÃ§Ã£o!";
      window.open(`https://wa.me/5534997178336?text=${encodeURIComponent(wa)}`,"_blank");
    });
  });
}

/* -------- Status/Countdown -------- */
function setStatusBanner(){
  const el = document.getElementById("status-banner");
  if (!el) return;
  const d = new Date();
  const dow = d.getDay(); // 0 Dom ... 6 SÃ¡b
  if (dow === 2){ el.textContent = "Fechado hoje (TerÃ§a) â€” voltamos amanhÃ£!"; return; }
  let openM = 0, closeM = 0, label = "";
  if (dow>=1 && dow<=4){ openM = 18*60; closeM = 23*60+15; label="Aberto atÃ© 23h15"; }
  else { openM = 17*60+30; closeM = 23*60+30; label="Aberto atÃ© 23h30"; }
  const nowM = d.getHours()*60 + d.getMinutes();
  if (nowM < openM){
    const h = Math.floor((openM-nowM)/60), m=(openM-nowM)%60;
    el.textContent = `Abrimos Ã s ${label.includes("23h15")?"18h":"17h30"} â€¢ falta ${h}h${String(m).padStart(2,"0")}m`;
  } else if (nowM <= closeM){
    el.textContent = `ğŸŸ¢ ${label}`;
  } else {
    el.textContent = "Fechado agora â€” abrimos no prÃ³ximo horÃ¡rio.";
  }
}
function updateCountdown(){
  const box = document.getElementById("timer");
  if (!box) return;
  const end = new Date(); end.setHours(23,59,59,999);
  const diff = end - new Date();
  if (diff<=0){ box.textContent="00:00:00"; return; }
  const h = Math.floor(diff/3_600_000);
  const m = Math.floor((diff%3_600_000)/60_000);
  const s = Math.floor((diff%60_000)/1000);
  box.textContent = `${String(h).padStart(2,"0")}:${String(m).padStart(2,"0")}:${String(s).padStart(2,"0")}`;
}

/* -------- Login (UI + placeholder Google) -------- */
function setupLoginUI(){
  // cria o botÃ£o no header se nÃ£o existir
  let userBtn = document.getElementById("user-btn");
  if (!userBtn){
    userBtn = document.createElement("button");
    userBtn.id = "user-btn";
    userBtn.className = "user-button";
    userBtn.textContent = "Entrar / Cadastrar";
    document.querySelector(".header")?.appendChild(userBtn);
  }
  const loginModal = document.getElementById("login-modal");
  userBtn.addEventListener("click", ()=>{
    loginModal.classList.add("show");
    document.body.classList.add("no-scroll");
  });
  loginModal.querySelector(".login-x").addEventListener("click", ()=>{
    loginModal.classList.remove("show");
    document.body.classList.remove("no-scroll");
  });
  loginModal.addEventListener("click",(e)=>{
    if (e.target === loginModal){
      loginModal.classList.remove("show");
      document.body.classList.remove("no-scroll");
    }
  });

  // BotÃ£o Google (placeholder: mostra alerta atÃ© configurar Firebase real)
  loginModal.querySelector(".btn-google").addEventListener("click",(e)=>{
    e.preventDefault();
    alert("Login com Google serÃ¡ ativado quando conectarmos ao seu Firebase (visual ok).");
    // Quando quiser ativar de verdade:
    // const provider = new firebase.auth.GoogleAuthProvider();
    // firebase.auth().signInWithPopup(provider)...
  });
}

/* -------- InicializaÃ§Ã£o -------- */
window.addEventListener("DOMContentLoaded", ()=>{
  // status/contador
  setStatusBanner(); setInterval(setStatusBanner, 60_000);
  updateCountdown(); setInterval(updateCountdown, 1000);

  // carrinho e botÃµes
  updateCartUI();
  bindAddButtons();
  bindExtrasButtons();

  // carrossel
  initCarousel();

  // login (UI)
  setupLoginUI();
});